---
title: "[Next.js Doc] 11. Route Handlers"
date: 2024-01-17
description: Next.js Doc - Route Handlers
---

#### ì°¸ê³  ë¬¸ì„œ

[Route Handlers â€“ Next.js doc](https://nextjs.org/docs/app/building-your-application/routing/route-handlers)

#### On this page

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ì›¹ [ìš”ì²­](https://developer.mozilla.org/docs/Web/API/Request) ë° [ì‘ë‹µ](https://developer.mozilla.org/docs/Web/API/Response) APIë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë¼ìš°íŠ¸ì— ëŒ€í•œ ì»¤ìŠ¤í…€ ë¦¬í€˜ìŠ¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
![image](https://github.com/tamoimi/tami-dev-blog/assets/100749520/a5bd0bd1-e0e3-49d5-98b1-4d7b89ead65e)

â˜„ï¸ **Good to know**

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `app` ë””ë ‰í„°ë¦¬ ë‚´ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. `page` ë””ë ‰í„°ë¦¬ ë‚´ì˜ [API ê²½ë¡œ](https://nextjs.org/docs/pages/building-your-application/routing/api-routes)ì™€ ë™ì¼í•˜ë¯€ë¡œ API ê²½ë¡œì™€ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í•¨ê»˜ ì‚¬ìš©í•  í•„ìš”ê°€ **ì—†ë‹¤**.

---

#### ì»¨ë²¤ì…˜

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `app`ë””ë ‰í„°ë¦¬ ë‚´ì˜ [`route.js|ts`Â file](https://nextjs.org/docs/app/api-reference/file-conventions/route)ì— ì •ì˜ë˜ì–´ ìˆë‹¤:

```tsx
// app/api/route.ts
export const dynamic = "force-dynamic"; // defaults to auto
export async function GET(request: Request) {}
```

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `page.js` ë° `layout.js`ì™€ ë¹„ìŠ·í•˜ê²Œ `app` ë””ë ‰í„°ë¦¬ ë‚´ì— ì¤‘ì²©ë  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ `page.js`ì™€ ê°™ì€ ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ ë ˆë²¨ì—ëŠ” `Route.js` íŒŒì¼ì´ ìˆì„ ìˆ˜ **ì—†ë‹¤**.

#### ì§€ì›ë˜ëŠ” HTTP ë©”ì„œë“œ

ë‹¤ìŒê³¼ ê°™ì€ [HTTP ë©”ì„œë“œ](https://developer.mozilla.org/docs/Web/HTTP/Methods)ë“¤ì´ ì§€ì›ëœë‹¤:Â `GET`,Â `POST`,Â `PATCH`,Â `DELETE`,Â `HEAD`.

ë§Œì•½ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ Next.jsëŠ” `405 Method Not Allowed` ì‘ë‹µì„ ë°˜í™˜í•œë‹¤.

#### í™•ì¥ëœ `NextRequest` ë° `NextResponse` API

ê¸°ë³¸ ìš”ì²­ ë° ì‘ë‹µì„ ì§€ì›í•˜ëŠ” ê²ƒ ì™¸ì—ë„ Next.jsëŠ” ì´ë¥¼ [NextRequest](https://nextjs.org/docs/app/api-reference/functions/next-request) ë° [NextResponse](https://nextjs.org/docs/app/api-reference/functions/next-response)ë¡œ í™•ì¥í•˜ì—¬ ë” í–¥ìƒëœ ì¼€ì´ìŠ¤ë“¤ì„ ìœ„í•´ í¸ë¦¬í•œ ë„êµ¬ë“¤ì„ ì œê³µí•œë‹¤.

---

#### Behavior

#### ìºì‹±

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” `Response` ê°ì²´ì™€ í•¨ê»˜ `GET` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ ìºì‹œëœë‹¤.

```tsx
// app/items/route.ts
export async function GET() {
  const res = await fetch("https://data.mongodb-api.com/...", {
    headers: {
      "Content-Type": "application/json",
      "API-Key": process.env.DATA_API_KEY,
    },
  });
  const data = await res.json();

  return Response.json({ data });
}
```

ğŸ¦§ **TypeScript Warning:**

`Response.json()`ì€ TypeScript 5.2ì—ì„œë§Œ ìœ íš¨í•˜ë‹¤. ë” ë‚®ì€ TypeScript ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ëŒ€ì‹  ì…ë ¥ëœ ì‘ë‹µì— [`NextResponse.json`](https://nextjs.org/docs/app/api-reference/functions/next-response#json)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

#### ìºì‹± ì„ íƒ í•´ì œ

ì•„ë˜ ë°©ë²•ìœ¼ë¡œ ìºì‹±ì„ ì„ íƒ í•´ì œí•  ìˆ˜ ìˆë‹¤:

- `GET` ë©”ì†Œë“œì™€ í•¨ê»˜ `Request` ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.
- ë‹¤ë¥¸ HTTP ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.
- `cookies` ë° `headers`ì™€ ê°™ì€ [ë™ì  ê¸°ëŠ¥](https://nextjs.org/docs/app/building-your-application/routing/route-handlers#dynamic-functions)ì„ ì‚¬ìš©í•œë‹¤.
- [ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„± ì˜µì…˜](https://nextjs.org/docs/app/building-your-application/routing/route-handlers#segment-config-options)ì€ ë™ì  ëª¨ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì§€ì •í•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´:

```tsx
// app/products/api/route.ts
export async function GET(request: Request) {
  const { searchParams } = new URL(request.url);
  const id = searchParams.get("id");
  const res = await fetch(`https://data.mongodb-api.com/product/${id}`, {
    headers: {
      "Content-Type": "application/json",
      "API-Key": process.env.DATA_API_KEY!,
    },
  });
  const product = await res.json();

  return Response.json({ product });
}
```

ë§ˆì°¬ê°€ì§€ë¡œ `POST` ë©”ì„œë“œëŠ” ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ê°€ ë™ì ìœ¼ë¡œ í‰ê°€ë˜ë„ë¡ í•œë‹¤.

```tsx
// app/items/route.ts
export async function POST() {
  const res = await fetch("https://data.mongodb-api.com/...", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "API-Key": process.env.DATA_API_KEY!,
    },
    body: JSON.stringify({ time: new Date().toISOString() }),
  });

  const data = await res.json();

  return Response.json(data);
}
```

â˜„ï¸ **Good to know**

API ë¼ìš°íŠ¸ ì²˜ëŸ¼ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” ì–‘ì‹ ì œì¶œ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. Reactì™€ ê¹Šì´ í†µí•©ë˜ëŠ” [í¼ê³¼ ë®¤í…Œì´ì…˜ì„ ì²˜ë¦¬](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions-and-mutations)í•˜ê¸° ìœ„í•œ ìƒˆë¡œìš´ ì¶”ìƒí™”ê°€ ì‘ì—… ì¤‘ì´ë‹¤.

#### ë¼ìš°íŠ¸ í•´ê²°

`route`ë¥¼ ê°€ì¥ ë‚®ì€ ìˆ˜ì¤€ì˜ ë¼ìš°íŒ… ê¸°ë³¸ ìš”ì†Œë¡œ ê³ ë ¤í•  ìˆ˜ ìˆë‹¤.

- `page`ì™€ ê°™ì€ ë ˆì´ì•„ì›ƒì´ë‚˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë„¤ë¹„ê²Œì´ì…˜ì—ëŠ” ê´€ì—¬í•˜ì§€ **ì•ŠëŠ”ë‹¤**.
- `page.js`ì™€ ê°™ì€ ê²½ë¡œì— `route.js` íŒŒì¼ì´ ìˆì„ ìˆ˜ **ì—†ë‹¤**.

| Page               | Route            | Result      |
| ------------------ | ---------------- | ----------- |
| app/page.js        | app/route.js     | âŒ Conflict |
| app/page.js        | app/api/route.js | âœ… Valid    |
| app/[user]/page.js | app/api/route.js | âœ… Valid    |

ê°ê°ì˜ `route.js` ì™€ `page.js` íŒŒì¼ì€ í•´ë‹¹ ê²½ë¡œì— ëŒ€í•œ ëª¨ë“  HTTP ë™ì‚¬ë¥¼ ì°¨ì§€í•œë‹¤.

```tsx
// app/page.js
export default function Page() {
  return <h1>Hello, Next.js!</h1>;
}

// âŒ Conflict
// `app/route.js`
export async function POST(request) {}
```

---

#### ì˜ˆì œ

ì•„ë˜ ì˜ˆì—ì„œëŠ” ë¼ìš°í„° í•¸ë“¤ëŸ¬ë¥¼ ë‹¤ë¥¸ Next.js API ë° ê¸°ëŠ¥ê³¼ ì–´ë–»ê²Œ ê²°í•©í•˜ëŠ”ì§€ ë³´ì—¬ì¤€ë‹¤.

#### ìºì‹œëœ ë°ì´í„° ì¬ê²€ì¦

[`next.revalidate`](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data) ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ [ìºì‹œëœ ë°ì´í„°ì˜ ìœ íš¨ì„±](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data)ì„ ë‹¤ì‹œ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤.

```tsx
// app/items/route.ts
export async function GET() {
  const res = await fetch("https://data.mongodb-api.com/...", {
    next: { revalidate: 60 }, // Revalidate every 60 seconds
  });
  const data = await res.json();

  return Response.json(data);
}
```

ë˜ëŠ” [ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„± ì¬ê²€ì¦ ì˜µì…˜](https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#revalidate)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```tsx
export const revalidate = 60;
```

---

#### ë™ì  í•¨ìˆ˜

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” [`cookies`](https://nextjs.org/docs/app/api-reference/functions/cookies)Â ë°Â [`headers`](https://nextjs.org/docs/app/api-reference/functions/headers)ì™€ ê°™ì€ Next.jsì˜ ë™ì  í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

#### ì¿ í‚¤

`next/headers`ì˜ [`cookies`](https://nextjs.org/docs/app/api-reference/functions/cookies)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ë¥¼ ì½ê±°ë‚˜ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì„œë²„ í•¨ìˆ˜ëŠ” Route Handlerì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ê±°ë‚˜ ë‹¤ë¥¸ í•¨ìˆ˜ ë‚´ì— ì¤‘ì²©ë  ìˆ˜ ìˆë‹¤.

ë˜ëŠ” [Set-Cookie](https://developer.mozilla.org/docs/Web/HTTP/Headers/Set-Cookie) í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ `Response`ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.

```tsx
// app/api/route.ts
import { cookies } from "next/headers";

export async function GET(request: Request) {
  const cookieStore = cookies();
  const token = cookieStore.get("token");

  return new Response("Hello, Next.js!", {
    status: 200,
    headers: { "Set-Cookie": `token=${token.value}` },
  });
}
```

ì›¹ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­([NextRequest](https://nextjs.org/docs/app/api-reference/functions/next-request))ì—ì„œ ì¿ í‚¤ë¥¼ ì½ì„ ìˆ˜ë„ ìˆë‹¤:

```tsx
// app/api/route.ts
import { type NextRequest } from "next/server";

export async function GET(request: NextRequest) {
  const token = request.cookies.get("token");
}
```

#### í—¤ë”

`next/headers`ì—ì„œ [`headers`](https://nextjs.org/docs/app/api-reference/functions/headers)ê°€ í¬í•¨ëœ í—¤ë”ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤. ì´ ì„œë²„ í•¨ìˆ˜ëŠ” Route Handlerì—ì„œ ì§ì ‘ í˜¸ì¶œë˜ê±°ë‚˜ ë‹¤ë¥¸ í•¨ìˆ˜ ë‚´ì— ì¤‘ì²©ë  ìˆ˜ ìˆë‹¤.

ì´ `headers` instanceëŠ” ì½ê¸° ì „ìš©ì´ë‹¤. í—¤ë”ë¥¼ ì„¤ì •í•˜ë ¤ë©´ ìƒˆ `headers`ê°€ í¬í•¨ëœ ìƒˆ `Response`ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.

```tsx
// app/api/route.ts
import { headers } from "next/headers";

export async function GET(request: Request) {
  const headersList = headers();
  const referer = headersList.get("referer");

  return new Response("Hello, Next.js!", {
    status: 200,
    headers: { referer: referer },
  });
}
```

ì›¹ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­([NextRequest](https://nextjs.org/docs/app/api-reference/functions/next-request))ì—ì„œ í—¤ë”ë¥¼ ì½ì„ ìˆ˜ë„ ìˆë‹¤:

```tsx
// app/api/route.ts
import { type NextRequest } from "next/server";

export async function GET(request: NextRequest) {
  const requestHeaders = new Headers(request.headers);
}
```

---

#### ë¦¬ë‹¤ì´ë ‰íŠ¸

```tsx
// app/api/route.ts
import { redirect } from "next/navigation";

export async function GET(request: Request) {
  redirect("https://nextjs.org/");
}
```

---

#### ë™ì  ë¼ìš°íŠ¸ ì„¸ê·¸ë¨¼íŠ¸

ğŸ¦§ ê³„ì†í•˜ê¸° ì „ì— [Defining Routes](https://nextjs.org/docs/app/building-your-application/routing/defining-routes) í˜ì´ì§€ë¥¼ ì½ì–´ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” [ë™ì  ì„¸ê·¸ë¨¼íŠ¸](https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì  ë°ì´í„°ì—ì„œ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

```tsx
// app/items/[slug]/route.ts
export async function GET(request: Request, { params }: { params: { slug: string } }) {
  const slug = params.slug; // 'a', 'b', or 'c'
}
```

| **Route**                   | **Example URL** | `params`        |
| --------------------------- | --------------- | --------------- |
| `app/items/[slug]/route.js` | `/items/a`      | `{ slug: 'a' }` |
| `app/items/[slug]/route.js` | `/items/b`      | `{ slug: 'b' }` |
| `app/items/[slug]/route.js` | `/items/c`      | `{ slug: 'c' }` |

---

#### URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì— ì „ë‹¬ëœ ìš”ì²­ ê°ì²´ëŠ” ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë” ì‰½ê²Œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ì—¬ [ëª‡ ê°€ì§€ ì¶”ê°€ í¸ì˜ ë©”ì„œë“œ](https://nextjs.org/docs/app/api-reference/functions/next-request#nexturl)ê°€ ìˆëŠ” `NextReques` ì¸ìŠ¤í„´ìŠ¤ë‹¤.

```tsx
// app/api/search/route.ts
import { type NextRequest } from "next/server";

export function GET(request: NextRequest) {
  const searchParams = request.nextUrl.searchParams;
  const query = searchParams.get("query");
  // query is "hello" for /api/search?query=hello
}
```

---

#### ìŠ¤íŠ¸ë¦¬ë°

ìŠ¤íŠ¸ë¦¬ë°ì€ AI ìƒì„± ì½˜í…ì¸ ë¥¼ ìœ„í•´ OpenAIì™€ ê°™ì€ LLM(Large Language Models)ê³¼ í•¨ê»˜ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. [AI SDK](https://sdk.vercel.ai/docs)ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ì.

```tsx
// app/api/chat/route.ts
import OpenAI from "openai";
import { OpenAIStream, StreamingTextResponse } from "ai";

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

export const runtime = "edge";

export async function POST(req: Request) {
  const { messages } = await req.json();
  const response = await openai.chat.completions.create({
    model: "gpt-3.5-turbo",
    stream: true,
    messages,
  });

  const stream = OpenAIStream(response);

  return new StreamingTextResponse(stream);
}
```

ì´ëŸ¬í•œ ì¶”ìƒí™”ëŠ” ì›¹ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•œë‹¤. ì›¹ APIë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.

```tsx
// app/api/route.ts
// https://developer.mozilla.org/docs/Web/API/ReadableStream#convert_async_iterator_to_stream
function iteratorToStream(iterator: any) {
  return new ReadableStream({
    async pull(controller) {
      const { value, done } = await iterator.next();

      if (done) {
        controller.close();
      } else {
        controller.enqueue(value);
      }
    },
  });
}

function sleep(time: number) {
  return new Promise((resolve) => {
    setTimeout(resolve, time);
  });
}

const encoder = new TextEncoder();

async function* makeIterator() {
  yield encoder.encode("<p>One</p>");
  await sleep(200);
  yield encoder.encode("<p>Two</p>");
  await sleep(200);
  yield encoder.encode("<p>Three</p>");
}

export async function GET() {
  const iterator = makeIterator();
  const stream = iteratorToStream(iterator);

  return new Response(stream);
}
```

---

#### ë¦¬í€˜ìŠ¤íŠ¸ ë°”ë””

í‘œì¤€ ì›¹ API ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `Request` bodyë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.

```tsx
// app/items/route.ts
export async function POST(request: Request) {
  const res = await request.json();
  return Response.json({ res });
}
```

---

#### ë¦¬í€˜ìŠ¤íŠ¸ ë°”ë”” í¼ ë°ì´í„°

`request.formData()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ `FormData`ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤:

```tsx
// app/items/route.ts
export async function POST(request: Request) {
  const formData = await request.formData();
  const name = formData.get("name");
  const email = formData.get("email");
  return Response.json({ name, email });
}
```

`formData` ë°ì´í„°ëŠ” ëª¨ë‘ ë¬¸ìì—´ì´ë¯€ë¡œ [`zod-form-data`](https://www.npmjs.com/zod-form-data)ë¥¼ ì‚¬ìš©í•˜ì—¬ ìš”ì²­ì„ ê²€ì¦í•˜ê³  ì›í•˜ëŠ” í˜•ì‹(ì˜ˆ: `number`)ìœ¼ë¡œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆë‹¤.

---

#### CORS(Cross-origin resource sharing)

í‘œì¤€ ì›¹ API ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `Response`ì— CORS í—¤ë”ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤:

```tsx
// app/api/route.ts
export const dynamic = "force-dynamic"; // defaults to auto

export async function GET(request: Request) {
  return new Response("Hello, Next.js!", {
    status: 200,
    headers: {
      "Access-Control-Allow-Origin": "*",
      "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
      "Access-Control-Allow-Headers": "Content-Type, Authorization",
    },
  });
}
```

---

#### Webhooks

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ íƒ€ì‚¬ ì„œë¹„ìŠ¤ë¡œë¶€í„° webhooksë¥¼ ìˆ˜ì‹ í•  ìˆ˜ ìˆë‹¤:

```tsx
// app/api/route.ts
export async function POST(request: Request) {
  try {
    const text = await request.text();
    // Process the webhook payload
  } catch (error) {
    return new Response(`Webhook error: ${error.message}`, {
      status: 400,
    });
  }

  return new Response("Success!", {
    status: 200,
  });
}
```

íŠ¹íˆ í˜ì´ì§€ ë¼ìš°í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” API ê²½ë¡œì™€ ë‹¬ë¦¬ ì¶”ê°€ êµ¬ì„±ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ `bodyParser`ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

---

#### Edge ì™€ Node.js Runtimes

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì—ëŠ” ìŠ¤íŠ¸ë¦¬ë° ì§€ì›ì„ í¬í•¨í•˜ì—¬ Edge ë° Node.js ëŸ°íƒ€ì„ì„ ëª¨ë‘ ì›í™œí•˜ê²Œ ì§€ì›í•˜ëŠ” isomorphic ì›¹ APIê°€ ìˆë‹¤.

ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ëŠ” í˜ì´ì§€ ë° ë ˆì´ì•„ì›ƒê³¼ ê°™ì€ [ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„±](https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config)ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì¼ë°˜ì ì¸ ëª©ì ì˜ [ì •ì ìœ¼ë¡œ ì¬ìƒì„±](https://nextjs.org/docs/app/building-your-application/data-fetching/fetching-caching-and-revalidating#revalidating-data)ëœ ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬ì™€ ê°™ì€ ì˜¤ë˜ ê¸°ë‹¤ë ¤ì˜¨ ê¸°ëŠ¥ë“¤ì„ ì§€ì›í•œë‹¤.

`runtime` ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„± ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ëŸ°íƒ€ì„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤:

```tsx
export const runtime = "edge"; // 'nodejs' is the default
```

---

#### ë¹„ UI ì‘ë‹µ

ë¼ìš°í„° í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ UIê°€ ì•„ë‹Œ ì½˜í…ì¸ ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤. [`sitemap.xml`](https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts), [`robots.txt`](https://nextjs.org/docs/app/api-reference/file-conventions/metadata/robots#generate-a-robots-file), [`app icons`](https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx)ë° [open graph images](https://nextjs.org/docs/app/api-reference/file-conventions/metadata/opengraph-image)ëŠ” ëª¨ë‘ ê¸°ë³¸ì ìœ¼ë¡œ ì§€ì›ëœë‹¤.

```tsx
// app/rss.xml/route.ts
export const dynamic = "force-dynamic"; // defaults to auto

export async function GET() {
  return new Response(
    `<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
 
<channel>
  <title>Next.js Documentation</title>
  <link>https://nextjs.org/docs</link>
  <description>The React Framework for the Web</description>
</channel>
 
</rss>`,
    {
      headers: {
        "Content-Type": "text/xml",
      },
    }
  );
}
```

---

#### ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„± ì˜µì…˜

ë¼ìš°í„° í•¸ë“¤ëŸ¬ëŠ” í˜ì´ì§€ ë° ë ˆì´ì•„ì›ƒê³¼ ê°™ì€ [ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ êµ¬ì„±](https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config)ì„ ì‚¬ìš©í•œë‹¤.

```tsx
// app/items/route.ts
export const dynamic = "auto";
export const dynamicParams = true;
export const revalidate = false;
export const fetchCache = "auto";
export const runtime = "nodejs";
export const preferredRegion = "auto";
```
